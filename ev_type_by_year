%store -r electric_vehicle_df

import matplotlib.pyplot as plt
import numpy as np
import pingouin as pg

ev_q4_df = electric_vehicle_df[["Model Year", "Electric Vehicle Type"]]
ev_BEV_df = ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Battery Electric Vehicle (BEV)"]
ev_PHEV_df = ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Plug-in Hybrid Electric Vehicle (PHEV)"]

BEV = ev_BEV_df["Model Year"]
PHEV = ev_PHEV_df["Model Year"]
q4_data = [BEV, PHEV]

fig = plt.figure(figsize =(10, 7))
plt.boxplot(q4_data)

plt.show()

ev_q4_summary = pd.DataFrame(
    {"EV Type": ["Battery Electric Vehicle (BEV)","Plug-in Hybrid Electric Vehicle (PHEV)"],
     "mean": [ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Battery Electric Vehicle (BEV)"]["Model Year"].mean().round(2), 
             ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Plug-in Hybrid Electric Vehicle (PHEV)"]["Model Year"].mean().round(2)],
     'std dev': [ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Battery Electric Vehicle (BEV)"]["Model Year"].std(), 
                ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Plug-in Hybrid Electric Vehicle (PHEV)"]["Model Year"].std()],
     'N': [len(ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Battery Electric Vehicle (BEV)"]),
           len(ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Plug-in Hybrid Electric Vehicle (PHEV)"])]
    })
ev_q4_summary

ev_q4_test = pd.DataFrame(
                {"Battery Electric Vehicle (BEV)": ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Battery Electric Vehicle (BEV)"]["Model Year"],
                 "Plug-in Hybrid Electric Vehicle (PHEV)": ev_q4_df.loc[ev_q4_df["Electric Vehicle Type"] == "Plug-in Hybrid Electric Vehicle (PHEV)"]["Model Year"]})

from pingouin import ttest

ttest(ev_q4_test["Battery Electric Vehicle (BEV)"], ev_q4_test["Plug-in Hybrid Electric Vehicle (PHEV)"], correction = True)

ev_q4_test.describe()
